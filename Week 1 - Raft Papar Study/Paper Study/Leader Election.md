# Leader Election

Raft알고리즘은 로그의 안정성과 일관성을 위해 리더를 선출하여 팔로워에게 단일 방향으로 로그를 전파하며 하트비트 메커니즘을 통해 리더를 선출한다.

## 서버의 시작과 팔로워 상태

1. 서버가 시작하면 팔로워 상태로 시작
2. 팔로워는 리더나 후보로부터 유효한 RPC를 받는 동안 팔로워 상태를 유지
3. 리더는 주기적으로 하트비트(로그 항목이 없는 ApendEntries RPC)를 팔로워에게 보내 자신의 권위를 유지
4. 팔로워가 일정 시간 동안 리더로부터 통신을 받지 못하면, 리더가 없다고 판단하고 선거를 시작

## 선거 과정

1. 후보가 전체 클러스터의 과반수(정족수) 서버로부터 동일한 임기에 대해 투표를 받으면 선거에서 승리
2. 각 서버는 임기당 최대 하나의 후보에게만 투표
3. 다수 ㅋ규칙은 특정 임기 동안 한 명의 후보만 선출될 수 있음을 보장
4. 후보가 선거에서 승리하면 리더가 되어 모든 서버에게 하트비트 메시지를 보내 권위를 확립하고 새로운 선거를 방지

## 후보 상태 유지

1. 후보는 다른 서버로부터 AppendEntries RPC를 받으면, 해당 서버가 리더로 확립되었음을 인정하고 팔로워 상태로 돌아감
2. 리더의 임기가 후보의 현재 임기와 같거나 클 경우, 후보는 이를 인정하고 팔로워 상태로 전환
3. 리더의 임기가 후보의 현재 임기보다 작을 경우, 후보는 RPC를 거부하고 후보 상태를 유지

## 선거 무승부

1. 여러 팔로워가 동시에 후보가 되면 투표가 나뉘어 과반수를 얻는 후보가 없을 수 있음
2. 이 경우, 각 후보는 타임아웃이 지나면 임기를 증가시키고 새로운 선거를 시작
3. 그러나, 추가 조치 없이 무승부가 계속될 수 있음

## 랜덤 선거 타임아웃

1. Raft는 무승부를 방지하기 위해 랜덤화된 선거 타임아웃을 사용
2. 선거 타임아웃은 고정된 간격(e.g. 150~300ms)에서 무작위로 선택됨
3. 이러한 특징으로 대부분의 경우 단일 서버만 타임아웃되어 선거에서 승리하고 다른 서버들이 타임아웃하기 전에 하트비트를 보냄
4. 각 후보는 선거 시작 시 랜덤화된 선거 타임아웃을 재설정하고, 타임아웃이 경과할 때까지 기다렸다가 다음 선거를 시
